# KBase

AIコーディングエージェント向けの構造化された自己組織型ナレッジベース。

[English](README.md) | [中文](README.zh-CN.md) | [Español](README.es.md) | [日本語](README.ja.md) | [Français](README.fr.md)

## 背景

KBaseはエージェントの知識——ルール、リファレンス、意思決定、スキル——をセッション間で永続化し、エージェントがゼロからではなく既知の状態で開始できるようにする。

## 構成

| ディレクトリ | 役割 |
|-------------|------|
| `ROOT/` | メタ原則、ブートストラップ、コマンド |
| `refs/` | 検証済み外部知識 |
| `notes/` | プロジェクトの知見と決定 |
| `skills/` | 自動化ワークフロー |
| `rules/` | 制約と規約 |
| `env/` | 環境設定 |
| `perms/` | シークレットと認証情報（gitignore対象） |
| `hooks/` | イベント駆動コールバック |
| `plans/` | 自動生成タスクプラン |

各ディレクトリには`AGENTS.md`（エージェント向けガイド）と`INDEX.md`（目次）の2ファイルが存在する。

## 原則

1. **能動的永続化** — エージェントは指示を待たず、発見を即座に保存する。
2. **権威あるソース** — すべての知識を一次ソースに対して検証する。未検証の知識は保存しない。
3. **ドキュメント先行** — 行動の前にドキュメントを更新する。競合時は下位層のソースを更新する。
4. **スキルディスパッチ** — アドホック作業の前に既存スキルを確認する。

## 通信プロトコル

KBaseはヒューマン・エージェント間の構造化された記法を定義する。完全仕様：[`ROOT/communication.md`](ROOT/communication.md)

| 記法 | 意味 |
|------|------|
| `[[ ... ]]` | 必須成果物 — 省略不可 |
| `[ ... ]` | 任意成果物 |
| `(( ... ))` | 必須制約 — 違反時はblocked |
| `( ... )` | 推奨制約 — ベストエフォート |
| `( ... ) > ~( ... )` | 優先＋抑制 — 左を優先、右の傾向を抑制 |
| `?( ... )` | 検証クエリ |
| `< ... >` | 入力コンテキスト |
| `<< ... >>` | 参照ポインタ |
| `->` | 制御フロー — `?( 条件 ) -> [ アクション ]` |
| `[ X ] : ( Y )` | レビュー修正（ソフト） — XをYに照らしてレビュー、未充足なら修正 |
| `[[ X ]] : (( Y ))` | レビュー修正（ハード） — Xを深くレビュー、Yを満たす必要あり |

状態遷移：`ready` → `done`（正常）または `ready` → `blocked`（競合・入力不足）。

## 権威層

| 層 | ソース |
|----|--------|
| 1 | `ROOT/` |
| 2 | `rules/` |
| 3 | `refs/` |
| 4 | `notes/` |
| 5 | 外部 |

上位層が下位層に優先する。競合時は下位層のソースを更新する。

## ライフサイクル

| 遷移 | 条件 |
|------|------|
| notes → refs | 一次ソースに対して検証済み |
| notes → rules | パターンが繰り返し発生し、制約化 |
| plans → notes/rules | プラン完了、成果を抽出 |

## クイックスタート

1. クローン：`git clone https://github.com/hayabusa-cloud/KBase.git`
2. AIコーディングエージェントの設定を`KBase/`ディレクトリに向ける。
3. 作業開始。エージェントはセッション開始時に`AGENTS.md`を読み込み、ナレッジベースを自己管理する。

## 自動保存

エージェントは発見を適切なディレクトリに自動保存する：

| 発見内容 | 保存先 |
|---------|--------|
| 制約、規約 | `rules/` |
| 知見、決定、パターン | `notes/` |
| 検証済み外部知識 | `refs/` |
| 自動化ワークフロー | `skills/` |
| タスクプラン | `plans/` |

手動で追加する場合は、対象ディレクトリにMarkdownファイルを作成し、その`INDEX.md`にエントリを追加する。

## ブートストラップ

セッション開始時、エージェントは以下の順序で読み込む：

`AGENTS.md` → `ROOT/AGENTS.md` → `ROOT/communication.md` → `ROOT/instructions.md` → `rules/INDEX.md` → `skills/INDEX.md` → `notes/INDEX.md`

コンテキスト圧縮後、エージェントは最低でも最初の4ファイルを再読み込みする。

## コマンド

```
research <topic>     情報を収集・検証し、refs/ または notes/ に保存
dive into <topic>    最新ソースを用いた多段階の深い調査
review <subject>     KBaseとウェブ調査に基づく評価
tidy <scope>         構成と内容の再整理。tidy all でKBase全体を整理
recall <topic>       外部検索の前にKBase内の既存知識を検索
save <topic>         発見を適切なディレクトリに保存し、INDEX.mdを更新
promote <file>       ノートをrefs/またはrules/に昇格；両方のINDEX.mdを更新
```

## ライセンス

[MIT](LICENSE) — ©2026 [Hayabusa Cloud Co., Ltd.](https://code.hybscloud.com)
